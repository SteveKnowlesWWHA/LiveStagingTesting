<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/10/2019 10:38:13 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="PC2RN3MJ2"
  DTS:CreatorName="WWHA\Hal.Jordan"
  DTS:DTSID="{90BD0EDE-3799-451E-A4B6-D4ADB004E270}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3026.27"
  DTS:LocaleID="2057"
  DTS:ObjectName="Live_CRM_PersonVulCurrToKeep"
  DTS:PackageType="5"
  DTS:VersionBuild="1"
  DTS:VersionGUID="{822F12C3-7F82-4BE8-857F-C123AF742DFF}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task - Step 0"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="if keep table exists, drops table and then renames current table to add KEEP, runs query against OH db and inserts "
      DTS:DTSID="{76139182-7586-4B97-A188-D78BD0EEEF60}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task - Step 0"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B98F0C27-9E59-411E-8D60-D3B41EEEBFDC}"
          SQLTask:SqlStatementSource="/*** Create New crm_PersonVulCurr2 using OPENQUERY SQL ***/&#xA;&#xA;use livedynamics;&#xA;&#xA;--1)clear the table out&#xA;IF OBJECT_ID('crm_PersonVulCurr2Keep', 'U') IS NOT NULL&#xA;  DROP TABLE  crm_PersonVulCurr2Keep;&#xA;&#xA;IF OBJECT_ID('crm_PersonVulCurr2') IS NOT NULL EXEC sp_rename 'dbo.crm_PersonVulCurr2', 'crm_PersonVulCurr2KEEP';&#xA;&#xA;IF OBJECT_ID('dbo.crm_PersonVulCurr2', 'U') IS NOT NULL &#xA;  DROP TABLE dbo.crm_PersonVulCurr2; &#xA;&#xA;&#xA;CREATE TABLE [dbo].[crm_personvulCurr2] (&#xA;[PersonRef] varchar(50),&#xA;[TenancyRef] varchar(50),&#xA;[PlaceRef] varchar(50),&#xA;[VulInds] varchar(100),&#xA;[LPRT] varchar(50)&#xA;)&#xA;GO&#xA;&#xA;insert into crm_personvulCurr2 (&#xA;[PersonRef],&#xA;[TenancyRef],&#xA;[PlaceRef],&#xA;[VulInds],&#xA;[LPRT])&#xA;&#xA;&#xA;select &#xA;&#x9;RTRIM([PERSON-REF]) AS PersonRef,&#xA;&#x9;isnull([TENANCY-REF],'') AS TenancyRef,&#xA;&#x9;isnull([PLACE-REF],'') AS PlaceRef,&#xA;&#x9;isnull([VULNERABLE-INDS],'') AS VulInds, &#xA;&#x9;isnull([LANGUAGE-CD],'') AS LPRT&#xA;&#xA;&#xA;&#x9;from Openquery(LIVE_OH, &#xA;&#xA;&#xA;'select &#xA;&#x9;TENANCY.&quot;TENANCY-REF&quot;,&#xA;&#x9;TENANCY.&quot;TNCY-STATUS&quot;,&#xA;&#x9;TNCYPLACE.&quot;PLACE-REF&quot;,&#xA;&#x9;TNCYPERSON.&quot;PERSON-REF&quot;,&#xA;&#x9;TNCYPERSON.&quot;ON-TNCY&quot;,&#xA;&#x9;TNCYPERSON.&quot;TNCY-SYS-REF&quot;,&#xA;    TNCYPERSON.&quot;MAIN-CONTACT&quot;,&#xA;&#x9;PERSON.&quot;LANGUAGE-CD&quot;,&#xA;&#x9;PERSONEXTENSION.&quot;VULNERABLE-INDS&quot;&#xA;    &#xA;&#x9;&#x9;from PUB.&quot;RE-TNCY-PERSON&quot; TNCYPERSON,&#xA;&#x9;PUB.&quot;IH-LOCATION&quot; LOCATION,&#xA;&#x9;PUB.&quot;RE-TNCY-PLACE&quot; TNCYPLACE,&#xA;&#x9;PUB.&quot;RE-TENANCY&quot; TENANCY,&#xA;&#x9;PUB.&quot;CO-PERSON&quot; PERSON&#xA;&#xA;&#x9;LEFT OUTER JOIN&#xA;&#x9;  &#xA;&#x9;PUB.&quot;CO-PERSON-EXTENSION&quot; PERSONEXTENSION ON PERSON.&quot;PERSON-REF&quot; = PERSONEXTENSION.&quot;PERSON-REF&quot; &#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#xA;where &#xA;&#x9;TENANCY.&quot;TNCY-STATUS&quot; = ''CUR''&#xA;&#x9;And LOCATION.&quot;MGT-AREA&quot; IN (''1'',''2'',''3'',''4'',''5'',''6'',''7'',''8'',''9'',''10'',''CARE'')&#xA;&#x9;and LOCATION.&quot;LOCATION-STS&quot; IN (''O'',''V'')&#xA;&#x9;and LOCATION.&quot;LOCATION-TYPE&quot; IN (''BLOCK'',''BUNGALOW'', ''FLAT'', ''HOUSE'', ''MAISONET'', ''ROOM'',''STUDIO'')&#xA;&#x9;and TNCYPERSON.&quot;PERSON-REF&quot; NOT IN (''1000182'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''1133011'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''1142667'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''12253321990076'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''13111499990023'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''15143313990557'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''18112311990199'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''18112314230009'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''18112314280001'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''23152223990013'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''4139127'', &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;''4140699'')&#xA;&#xA;&#x9;&#xA;&#x9;and TNCYPLACE.&quot;ORG-CODE&quot; = TENANCY.&quot;ORG-CODE&quot;&#xA;&#x9;and TNCYPLACE.&quot;TNCY-SYS-REF&quot; = TENANCY.&quot;TNCY-SYS-REF&quot; &#xA;&#x9;and TNCYPLACE.&quot;ORG-CODE&quot; = LOCATION.&quot;ORG-CODE&quot; &#xA;&#x9;and TNCYPLACE.&quot;PLACE-REF&quot; = LOCATION.&quot;PLACE-REF&quot; &#xA;&#x9;and TENANCY.&quot;ORG-CODE&quot; = TNCYPERSON.&quot;ORG-CODE&quot; &#xA;&#x9;and TENANCY.&quot;TNCY-SYS-REF&quot; = TNCYPERSON.&quot;TNCY-SYS-REF&quot;&#xA;&#x9;and TNCYPERSON.&quot;PERSON-REF&quot; =PERSON.&quot;PERSON-REF&quot;&#xA;&#xA;&#xA;&#x9;')&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task - Step 1"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Deletes rows from table where null or blanks"
      DTS:DTSID="{CEA32632-F8C3-4372-AAD8-654A3A3C097C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task - Step 1"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B98F0C27-9E59-411E-8D60-D3B41EEEBFDC}"
          SQLTask:SqlStatementSource="use livedynamics;&#xA;&#xA;Delete from crm_personvulCurr2 where PersonRef is null OR PersonRef='';&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task - Step 2"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="if keep table exists, drops table and then renames current table to add KEEP, runs query against OH db and inserts "
      DTS:DTSID="{77CDF445-83E5-4F37-A7ED-AF8DB1E0B200}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task - Step 2"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B98F0C27-9E59-411E-8D60-D3B41EEEBFDC}"
          SQLTask:SqlStatementSource="Use livedynamics;&#xA;&#xA;IF OBJECT_ID('crm_personvulCurrKeep', 'U') IS NOT NULL&#xA;  DROP TABLE crm_personvulCurrKeep&#xA;&#xA;select * into&#xA;crm_personvulCurrKeep&#xA;from crm_personvulCurr &#xA;&#xA;declare @ids  TABLE &#xA;&#xA;(&#xA;&#x9;personref varchar(50),&#xA;&#x9;vul  varchar(10)&#xA;)&#xA;&#xA;declare @personref as varchar(50)&#xA;declare @vuls as varchar(100)&#xA;&#xA;DECLARE myCursor CURSOR FOR&#xA;select personref,vulinds from crm_personvulCurr2&#xA;&#x9;OPEN myCursor&#xA;&#xA;&#x9;FETCH NEXT FROM myCursor&#xA;&#x9;INTO @personref, @vuls&#xA;&#xA;&#x9;WHILE @@FETCH_STATUS = 0&#xA;&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;insert into @ids (personref,vul)&#xA;&#x9;&#x9;SELECT * FROM dbo.split_vulids(@personref, @vuls) where vul!=''&#xA;&#xA;&#x9;&#x9; FETCH NEXT FROM myCursor&#xA;&#x9;&#x9;INTO @personref, @vuls&#xA;&#xA;&#x9;END &#xA;CLOSE myCursor&#xA;DEALLOCATE myCursor&#xA;&#xA;&#xA;&#xA;delete from crm_personvulCurr&#xA;&#xA;insert into crm_personvulCurr ( personref, tenancyref,placeref,CAUD, CBRA, CBSL, CCD, CRED, CWRT, DIHE, DILI, DILT, DIMH, DIMI, DISV, DIWU, INFO, [PERM], PVDNV, PVLM, PVMEN, PVPOL, PVVIP, CLPT,lprt, DILD, DISD, DOTH, DNOT)&#xA;select personref, tenancyref,placeref,CAUD, CBRA, CBSL, CCD, CRED, CWRT, DIHE, DILI, DILT, DIMH, DIMI, DISV, DIWU, INFO, [PERM], PVDNV, PVLM, PVMEN, PVPOL, &#xA;                      PVVIP, CLPT,lprt,DILD, DISD, DOTH, DNOT &#xA;from &#xA;(&#xA;select crm_personvulCurr2.personref, vul,TenancyRef,placeref,case &#xA;&#x9;  when [lprt]='' then 0&#xA;&#x9;  else 1 end as lprt&#xA; FROM         dbo.crm_personvulCurr2 LEFT OUTER JOIN&#xA;                     @ids as idtbl ON dbo.crm_personvulCurr2.PersonRef = idtbl.PersonRef&#xA;) as o&#xA;pivot (count(vul) for vul in(CAUD, CBRA, CBSL, CCD, CRED, CWRT, DIHE, DILI, DILT, DIMH, DIMI, DISV, DIWU, INFO, [PERM], PVDNV, PVLM, PVMEN, PVPOL, &#xA;                      PVVIP, CLPT,DILD, DISD, DOTH, DNOT) ) as p&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;   where personref !=''&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  order by personref&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task - Step 3"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Updates certain values based on the SQL below"
      DTS:DTSID="{D385D52A-C50C-43F6-AEBA-A31500C7DD61}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task - Step 3"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B98F0C27-9E59-411E-8D60-D3B41EEEBFDC}"
          SQLTask:SqlStatementSource="/** update the importer columns **/&#xA;use livedynamics;&#xA;&#xA;DECLARE @id INT&#xA;SET @id=0&#xA;update crm_PersonvulCurr set @id=ImportTransactionId=@id+1&#xA;GO&#xA;;&#xA;update crm_PersonvulCurr set ImportType='C';&#xA;update crm_PersonvulCurr set SubmittedOn= GetDate();&#xA;update crm_PersonvulCurr set Importstatus='Pending';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{96EF7F62-49F9-4682-B21F-CA917B4622F1}"
      DTS:From="Package\Execute SQL Task - Step 0"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Execute SQL Task - Step 1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{4DBAE855-CE48-4C13-A006-18E7795CD775}"
      DTS:From="Package\Execute SQL Task - Step 1"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Execute SQL Task - Step 2" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{FD3B72B4-CDF5-4307-961D-7DCAA8F5BE27}"
      DTS:From="Package\Execute SQL Task - Step 2"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Execute SQL Task - Step 3" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="204,42"
          Id="Package\Execute SQL Task - Step 0"
          TopLeft="63,45" />
        <NodeLayout
          Size="204,42"
          Id="Package\Execute SQL Task - Step 1"
          TopLeft="261,158" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="165,87">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="198,71"
              Start="0,0"
              End="198,63.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.5"
                    Point2="0,35.5"
                    Point3="4,35.5" />
                  <mssgle:LineSegment
                    End="194,35.5" />
                  <mssgle:CubicBezierSegment
                    Point1="194,35.5"
                    Point2="198,35.5"
                    Point3="198,39.5" />
                  <mssgle:LineSegment
                    End="198,63.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="204,42"
          Id="Package\Execute SQL Task - Step 2"
          TopLeft="490,272" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="363,200">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="229,72"
              Start="0,0"
              End="229,64.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32" />
                  <mssgle:CubicBezierSegment
                    Point1="0,32"
                    Point2="0,36"
                    Point3="4,36" />
                  <mssgle:LineSegment
                    End="225,36" />
                  <mssgle:CubicBezierSegment
                    Point1="225,36"
                    Point2="229,36"
                    Point3="229,40" />
                  <mssgle:LineSegment
                    End="229,64.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="204,42"
          Id="Package\Execute SQL Task - Step 3"
          TopLeft="722,388" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="592,314">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="232,74"
              Start="0,0"
              End="232,66.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33" />
                  <mssgle:CubicBezierSegment
                    Point1="0,33"
                    Point2="0,37"
                    Point3="4,37" />
                  <mssgle:LineSegment
                    End="228,37" />
                  <mssgle:CubicBezierSegment
                    Point1="228,37"
                    Point2="232,37"
                    Point3="232,41" />
                  <mssgle:LineSegment
                    End="232,66.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>